require 'rails_helper'
require_relative '../../../lib/mss/mss_wrapper'

describe MssWrapper do
  context "#verify" do
    it "receive message, signature and key, then validate them" do
      # Long Johnson, Don Piano
      message = "TG9uZyBKb2huc29uLCBEb24gUGlhbm8K"
      signature = "DAAADADq2fxR8CjxvoCNi1NhFoiWAA0ADJyJ962DKj722xfN4Dqp7gEHAKaDPLurqsA7dx09wUnlIAMCAgAZZxaUebvFN+ueXZJwlMHKAwAAg2bn9RXyi5KvvxXg8z5LLQQBAK4vys+N2HYJRHnK854DIrYFAQCyRiL+r/dLlNdLgASpAFRnBgEAwrLkfjnmn4W/61jAix7m8wcBAG9lOuWDpiSMMTQPG8h9j6UIAQC2WUTdw2/MjQ1yfNknqDhDCQEA5v0lhv8KjmxI/kv/y3xGKgoBACcqEvyl4lt/Pnsu2ioVQ8g4Pe7vTqPxQqWx06nVVou1vMAXeC8Fyz6O5dnWY2prrS+fZbce1fVn6z8iqhPSFM/Ucd4ILkLy/cwkH+TJMSbwXWorRABHCJNiYfIZtBETc6NoEohbeG2luv4d/vovvAHIqRTlt1cI7zhdSN+4uFQG5kFRb0JrEIK8yrDmc4AerHHverR/jgPG+y14ERwBvYGl+hazYouPRg+DLH4L4hBLSQ8lNZwE8jcTGgKxMPugbOJQgmeZtmQ19IhznL7M+XWsVAbbdeV4F4hw1eg1+a5nQMDBdY3Bk9veWgcepWKfMHH/t/i1jTr08rstubTCFvZv1PMjzonLr+LQlvzcSGw0P7NNS4cLNx2MuTSclmKXYbwhp1v/6TR2eODpRC2tE+aNICasty+sF25DEOnZLlPeTGMqXU/edZEZTb3Jrp6BgFE3sxhokoKZA9Yx/01VJVqyNNNOankLkz3wUxOObIIbhvedikNyY6Q8tAG735G6B+9JL+ZA+oPlZEYll//cX4yEiJF+H/NxMXpvElqiMzzZgUaUqotTWS5cHJ5BrUU3zO4B9e3B1wj2KvMpmWlKHyUUoeaVcqABX2oOKleOlWJIU7CffbqJtnuxS5sSaNiaoOhrZsUZB7H4islTPXxd2Gy4P+IHUSKu9LQ3Nk9CDhdPCebs3yyJkl58cMCwGAfsGYB22be9vyzCAYZkt3y9GWYXVZi0XHXqW1hNNxUD8Q7Uq1ztfDHnWjwE0Wuij1IA+ZCPiWPdp0+Flj0VZHDCN2Qq3RbOerOCHYsyW9CBqmcTl3xECDWTwQW+7HglNdviDzubSztnP/bORYyUKexngY6h1NG2JBgzlEsZclC6eHzW+JWXvaGXicAcupOGZtElmrXPAl6X+6fR5lS9ZNf1iRqahgzXAz/X7mAud7q5ZFb+r9bkim4/kL8tGPgLyNHus3We/vahRFTGVU1iRW00Uqrz3DqjRTYpS8MclRzg4UP7jVe2oQjRYlfWLEhMKR6RAtlWk9Y3KPF9Rr6Ohie9JYD1zz7a7wKRuP8sh2yVTQl9+UYcvCc5DMCSmU4wXPLU4aqZ5Ei8t+2VH8osGro1uaSIahIIwvA06ORvIMEhvzgUU0Bn7O7wGAqEXuJN7jR7YI6IiVUtu6egVKcSHbqe5kH+WRMWjaf036zeGQi0oYgAj5bpI4sVrAxVcLwrU7/FCNsYdmo8sTxgY4oX+jCMhDEBI+cXIqUUollXajZ5rmq/BS3PI5zRrdarq/UZbkK/VPw1C19T8+2VTswgT3vts+zSfsiuuQClTI3YRY361A9fQN/01ujR5YPiB3aL7DnZ26Pwcm3qaMeUcqt8UpWO72GBtB1RhwmUbTxnkinv0fCgSU+mVZlmbU/CHm69T3swlUaEcrkRQoFDQeONYz5VxNFHRmlNjcKnd/wu48ViqpZtXNWCobDf7s5nlRk/IMZHsQ=="
      key = "Xk34Lamo6hUUBCkCZBrOKg=="
      expect(MssWrapper.verify(message, signature, key)).to eq true
    end
    it "receive wrong message, signature and key, then validate them" do
      message = "Wrong message"
      signature = "DAAADADq2fxR8CjxvoCNi1NhFoiWAA0ADJyJ962DKj722xfN4Dqp7gEHAKaDPLurqsA7dx09wUnlIAMCAgAZZxaUebvFN+ueXZJwlMHKAwAAg2bn9RXyi5KvvxXg8z5LLQQBAK4vys+N2HYJRHnK854DIrYFAQCyRiL+r/dLlNdLgASpAFRnBgEAwrLkfjnmn4W/61jAix7m8wcBAG9lOuWDpiSMMTQPG8h9j6UIAQC2WUTdw2/MjQ1yfNknqDhDCQEA5v0lhv8KjmxI/kv/y3xGKgoBACcqEvyl4lt/Pnsu2ioVQ8g4Pe7vTqPxQqWx06nVVou1vMAXeC8Fyz6O5dnWY2prrS+fZbce1fVn6z8iqhPSFM/Ucd4ILkLy/cwkH+TJMSbwXWorRABHCJNiYfIZtBETc6NoEohbeG2luv4d/vovvAHIqRTlt1cI7zhdSN+4uFQG5kFRb0JrEIK8yrDmc4AerHHverR/jgPG+y14ERwBvYGl+hazYouPRg+DLH4L4hBLSQ8lNZwE8jcTGgKxMPugbOJQgmeZtmQ19IhznL7M+XWsVAbbdeV4F4hw1eg1+a5nQMDBdY3Bk9veWgcepWKfMHH/t/i1jTr08rstubTCFvZv1PMjzonLr+LQlvzcSGw0P7NNS4cLNx2MuTSclmKXYbwhp1v/6TR2eODpRC2tE+aNICasty+sF25DEOnZLlPeTGMqXU/edZEZTb3Jrp6BgFE3sxhokoKZA9Yx/01VJVqyNNNOankLkz3wUxOObIIbhvedikNyY6Q8tAG735G6B+9JL+ZA+oPlZEYll//cX4yEiJF+H/NxMXpvElqiMzzZgUaUqotTWS5cHJ5BrUU3zO4B9e3B1wj2KvMpmWlKHyUUoeaVcqABX2oOKleOlWJIU7CffbqJtnuxS5sSaNiaoOhrZsUZB7H4islTPXxd2Gy4P+IHUSKu9LQ3Nk9CDhdPCebs3yyJkl58cMCwGAfsGYB22be9vyzCAYZkt3y9GWYXVZi0XHXqW1hNNxUD8Q7Uq1ztfDHnWjwE0Wuij1IA+ZCPiWPdp0+Flj0VZHDCN2Qq3RbOerOCHYsyW9CBqmcTl3xECDWTwQW+7HglNdviDzubSztnP/bORYyUKexngY6h1NG2JBgzlEsZclC6eHzW+JWXvaGXicAcupOGZtElmrXPAl6X+6fR5lS9ZNf1iRqahgzXAz/X7mAud7q5ZFb+r9bkim4/kL8tGPgLyNHus3We/vahRFTGVU1iRW00Uqrz3DqjRTYpS8MclRzg4UP7jVe2oQjRYlfWLEhMKR6RAtlWk9Y3KPF9Rr6Ohie9JYD1zz7a7wKRuP8sh2yVTQl9+UYcvCc5DMCSmU4wXPLU4aqZ5Ei8t+2VH8osGro1uaSIahIIwvA06ORvIMEhvzgUU0Bn7O7wGAqEXuJN7jR7YI6IiVUtu6egVKcSHbqe5kH+WRMWjaf036zeGQi0oYgAj5bpI4sVrAxVcLwrU7/FCNsYdmo8sTxgY4oX+jCMhDEBI+cXIqUUollXajZ5rmq/BS3PI5zRrdarq/UZbkK/VPw1C19T8+2VTswgT3vts+zSfsiuuQClTI3YRY361A9fQN/01ujR5YPiB3aL7DnZ26Pwcm3qaMeUcqt8UpWO72GBtB1RhwmUbTxnkinv0fCgSU+mVZlmbU/CHm69T3swlUaEcrkRQoFDQeONYz5VxNFHRmlNjcKnd/wu48ViqpZtXNWCobDf7s5nlRk/IMZHsQ=="
      key = "Xk34Lamo6hUUBCkCZBrOKg=="
      expect(MssWrapper.verify(message, signature, key)).to eq false
    end
  end
end
